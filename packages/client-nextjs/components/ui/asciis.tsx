// components/ui/asciis.tsx
import React, { forwardRef, useEffect } from "react";

export interface AsciiArtProps {
    neonColors?: string[];
    glitchMode?: boolean;
    flashSpeed?: number;
    flashIntensity?: number;
    onMouseDown?: React.MouseEventHandler<HTMLCanvasElement>;
}

const AsciiArt = forwardRef<HTMLCanvasElement, AsciiArtProps>(
    ({ neonColors, glitchMode, flashSpeed = 3, flashIntensity = 5, onMouseDown }, ref) => {

        useEffect(() => {
            if (ref && "current" in ref && ref.current) {
                const canvas = ref.current;
                const ctx = canvas.getContext("2d");

                if (!ctx) return;

                const draw = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = glitchMode ? `rgba(0, 255, 255, ${flashIntensity / 10})` : "black";
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    ctx.fillStyle = neonColors?.[Math.floor(Math.random() * neonColors.length)] || "#0ff";
                    ctx.font = "12px monospace";
                    ctx.fillText(asciiArt, 10, 20);
                };

                const interval = setInterval(draw, 1000 / flashSpeed);
                return () => clearInterval(interval);
            }
        }, [glitchMode, flashSpeed, flashIntensity, neonColors]);

        const asciiArt = `
##############################%@@@@@@@%%%%%##############%######**##################################
############################%%@@@@@@@@@@%%%%%%%##########%%######**#################################
###########################%@@@@@@@@@@@@@@@@@@@@@@@%%%%###%###**###*+###############################
##########################%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@%%###++###*-*%############################
#########################%@@@@@@@@@@@@@@@@@@@@@@@%%%%#++=#%@%###*+###*-*############################
########################%@@@@@@@@@@@@@@@@@@@@%%##+=+=*=-==+*##+#%#%###*=*%##########################
#######################%@@@@@@@@@@@@@@@@@@@@@%%%%@%%%%%+=--=:===#*+%%##+:*##########################
######################%@@@@@@@@@@@@@@%@@#%#%%@@@@%@%%%@@@%*#+=*--*:*@%##=-##########################
#####################%@@@@@@@@@@@@@@@%%#%@#+**#%%%###*#%%@@%%%%#==+-%@+*%**#########################
#####################@@@@@@@@@@@@@@@@%%+*****##**+++++*#*#@@@@@%%**=#@#:*%##########################
####################%@@@@@@@@@@@@@@@@*%*++*%%*+++***#%@+-*%%%@@@@@%**@%+=++#########################
####################@@@@@@@@@%@@@@@#%**+*%@#***#%%@@@@*..+%%%@@@@@@%%%@%%*-=*#######################
###################%@@@@@@@@@#%%@@##*+*#@@%*#%%%@@%%#%-  =%%@@@@@@@@@#%@@@#:-*######################
###################%@@@@@@@%@#*##%#***%@@%##%%*####*%*:. =%%@@@@@@@@@##@@@%=--######################
###################@@@@@@@%###++*****####*##%===##%%*-  .+*%@@@@@@@@@*#%@@@##--*####################
###################@@@@@@%%%%%#**#*********#######**+. .+-*#@@@@@@@@@*%@@@@%%*:-+###################
#%%%+*#############@@@@@@%%###%%%%%#**+*++******+***=.-+=:+#@@@@@@@@@#%@@@@%@@+--=*#################
#%@@#*#############%@%@@@#**#%%%%%%#*******+++++****++*+:--#@@@@@@@@@%%@@@@@@@@*-=++*################
##@@%###############%%@@@@%%@%++####*+=+***++++**+++***--:-@@@@@@@@@%%@@@@@@@%+==+**################
%@%@@#+#############%#%@@@@%@%*+###**- .-**+++**+++++*+=: +@@@@@@@%@%@@@@@@@@@=:+-=*################
#@#%@@*################%%@@@%%###****+++=*+++*++++++*+-. .%@@@@%@@%@%@@@@@@@@@-.-=-=################
#%%#@@##%################%@@%#******##***++++++++++++:   -%@@@%@@%%@@@@@@@@@@#::===:=*##############
##%#%@%*#################%@@@%****++**++*#**+++++++=:   .*@@@%%@@%%@@@@@@@@@%*:-----:==*############
###@*%@#*################%@@@@***+++++*%@%%@%%#++++:   .=#@@@@%@%%%@@@@@%@@%#**%#=.--=+++*##########
###%%#@@**##############@@@@@@%***++++#@@%%%%*++++-    -*%@@%%%%%%@@@@@@%%%*##%@%#=:--+**++#########
###%@#%@@*#############%@%%@@@@@#+++++*%%##**+++=:    :+#@@%%%%%%%@@@@%%%*#*%%@@%%#=:-=####++*######
###%@%%@@%#%%%########%%%%%@@@@@@%*+++++*****=::.    .*#@@%#%%%%%%@@@%%##=*%%@@@%%@%=::+###%#++*####
%%@@@%%%@@%@%#@%###########%@@@@@@@%*++++*+++-     .-*#%%%##%%%%@@%%%%%%%%%%%%%%%#%%%@*:..+*####%#**
@@@%%%%@@@@%@*%%###########@@@@@@@@@@@#*++++++:..-=*####%#*%%%%@@%%%%%%%%%%%%%%%#%#%%+:-:+*#######%
@@@@@@@@@@@%#%#############%@@@@@@@@@@@@%#*+++**#%###***#*#%@@@%%#####%%#%%%%%%%%#%#%%-+:+*#####**
@@@@@@@%%@@@@#@%%###########@@@@@@@@@@@@@@@%%@@@%###**+*#%%@@@%%%#++==+#%%%%%%%%%%###%%--+:+*#####**
@@@@@@@%%@@@@#@%%###########@@@@@@@@@@@@@@@%%@@@%###**+*#%%@@@%%%#++==+#%%%%%%%%%%###%%--+:+*#####**
`;

        return (
            <canvas
                ref={ref}
                onMouseDown={onMouseDown}
                style={{
                    width: "800px",
                    height: "800px",
                    backgroundColor: "black",
                }}
            />
        );
    }
);

export default AsciiArt;
